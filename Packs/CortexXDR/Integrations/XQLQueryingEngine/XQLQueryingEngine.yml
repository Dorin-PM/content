beta: false
category: Endpoint
commonfields:
  id: XQLQueryingEngine
  version: -1
configuration:
- defaultvalue: https://example.com/
  display: Your server URL
  name: url
  required: true
  type: 0
- additionalinfo: The API Key to use for connection
  display: API Key
  name: apikey
  required: true
  type: 4
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- additionalinfo: The API Key ID to use for connection
  display: API Key ID
  hidden: false
  name: apikey_id
  required: false
  type: 4
description: '[Enter a comprehensive, yet concise, description of what the integration
  does, what use cases it is designed for, etc.]'
display: XQLQueryingEngine
name: XQLQueryingEngine
script:
  commands:
  - arguments:
    - default: false
      description: String of the XQL query.
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: |-
        Timestamp in relative date format for query device control events from Cortex XDR.
        For example "1 day", "3 weeks".
      isArray: false
      name: time_frame
      required: false
      secret: false
    - default: false
      description: 'List of strings used for running APIs on local and Managed Security
        tenants. Valid values:'
      isArray: true
      name: tenant_id
      required: false
      secret: false
    deprecated: false
    description: Execute an XQL query.
    execution: false
    name: xdr-start-xql-query
    outputs:
    - contextPath: PaloAltoNetworksXDR.XQL.query.ExecutionID
      description: An integer representing a unique ID of a successful XQL query execution.
        The value is used to call the Get XQL Query Results API.
      type: String
  - arguments:
    - default: false
      description: Integer representing the unique execution ID generated by the response
        to Start an XQL Query API.
      isArray: false
      name: query_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: |-
        String representing the type of response output. Valid values:
        json (default)
        csv
      isArray: false
      name: format
      predefined:
      - json
      - csv
      required: false
      secret: false
    - default: false
      description: |-
        Integer representing the maximum number of results to return. For example:
        If limit = 100 and the query produced 1,000 results, only the first 100 results will be returned.
        If limit = 100 and the query produced 50 results, only 50 results will be returned.
      isArray: false
      name: limit
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: |-
        Boolean flag indicating whether the API call should operate in synchronous\blocking mode, or in asynchronous\non-blocking mode. Valid Values:
        true (default)—The call returns immediately with one of the following options:
        PENDING status indicating query hasn't yet completed or results are not yet ready to be returned. Need to execute the API call again.
        SUCCESS/FAIL status
        false—The API will block until query completes and results are ready to be returned.
      isArray: false
      name: pending_flag
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    description: |-
      Retrieve results of an executed XQL query API.
      Maximum result set size is 1000. The API does not support pagination, therefore, you can set values to determine the result size limitation and how to wait for the results. To view response with greater than 1000 results you must call Get XQL Query Results Stream.
    execution: false
    hidden: false
    name: xdr-get-xql-query-results
    outputs:
    - contextPath: PaloAltoNetworksXDR.XQL.Query.Status
      description: |-
        String representing the status of the API call; SUCCESS, FAIL, or PENDING.
        For multi-tenant queries, PARTIAL_SUCCESS—At least one tenant failed to execute the query. Only partial results are available.
      type: String
    - contextPath: PaloAltoNetworksXDR.XQL.Query.NumberOfResults
      description: Integer representing the number of results returned.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.XQL.Query.QueryCost
      description: |-
        Float representing the number of query units collected for this API. For example, {"local_tenant_id": 0.01}.
        For multi-tenant queries, the field displays a value per child tenant. For example, {"tenant_id_1": 0.01, "tenant_id_2": 2.3}.
      type: Unknown
    - contextPath: PaloAltoNetworksXDR.XQL.Query.RemainingQuota
      description: Float representing the number of query units available for you
        to use.
      type: Number
    - contextPath: PaloAltoNetworksXDR.XQL.Query.Results
      description: |-
        Displays the API response in either of the following fields according to the number of results:
        data—API results according to defined format field.
        stream_id—String representing a unique ID of more than 1000 number of results. Use the ID to call Get XQL Results Stream API to retrieve the results.
      type: Unknown
  - deprecated: false
    description: Retrieve the amount of query quota available and used.
    execution: false
    hidden: false
    name: xdr-get-xql-quota
    outputs:
    - contextPath: PaloAltoNetworksXDR.XQL.Query.Quota.LicenseQuota
      type: Number
    - contextPath: PaloAltoNetworksXDR.XQL.Query.Quota.AdditionalPurchasedQuota
      type: Number
    - contextPath: PaloAltoNetworksXDR.XQL.Query.Quota.UsedQuota
      type: Number
  dockerimage: demisto/python3:3.9.5.21272
  feed: true
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
fromversion: 5.5.0
